<?xml version="1.0" encoding="utf-8" ?>
<odoo>
  <report id="report_session" model="account.move" string="Factura Beeren" 
  name="factura_formulario.report_factura_beeren" file="factura_formulario.report_session" report_type="qweb-pdf" />
  
  <template id="report_factura_beeren">
    <t t-call="web.html_container">
      <t t-set="data_report_margin_top" t-value="12"/>
      <t t-set="data_report_header_spacing" t-value="0"/>
      <!--<t t-set="data_report_dpi" t-value="110"/>-->
        <t t-foreach="docs" t-as="o">
            <t t-call="web.basic_layout">

                <div class="container-fluid">
                  <div class="row" style="font-size: 12px;">
                    <div class="col-4 text-left" style="font-size: 10px; color: BLACK; border: 0px solid #000;">
                      <img t-att-src="image_data_uri(o.company_id.logo)" width="118px" height="60px"/>
                    </div>
                    <div class="col-4 text-left" style="font-size: 10px; color: BLACK; border: 0px solid #000;">
                      <span t-field="o.company_id.name"/><br/>
                      <span t-field="o.company_id.street"/><br/>
                      <span t-field="o.company_id.city"/>
                      <span t-field="o.company_id.state_id"/><br/>
                      <span t-field="o.company_id.country_id"/><br/>
                    </div>
                    <div class="col-4 text-left" style="font-size: 10px; color: BLACK; border: 0px solid #000;">
                      CP:<span t-field="o.company_id.zip"/><br/>
                      RFC:<span t-field="o.company_id.vat"/><br/>
                      Regimen Fiscal: General de Ley Personas Morales<br/>
                      Expedido en: LAGOS DE MORENO, Jalisco, C.P.47400
                    </div>
                  </div>
                </div>

                <div class="page" style="max-width:100mm">
                  <div class="row texty-center">
                    <!--<img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo"/>-->
                    <div class="col-12"><h3><br/>Factura <span t-field="o.name"/></h3></div>
                    <t t-set="cfdi_vals" t-value="o._l10n_mx_edi_decode_cfdi()"/>
                    <t t-set="is_cfdi_signed" t-value="bool(o._get_l10n_mx_edi_signed_edi_document())"/>
                  </div>
                </div>

                <div class="container-fluid">
                  <div class="row">
                    <!--<div class="col-6 text-left p-3" style="font-size: 10px; color: BLACK; border: 0px solid #000;">
                      <h6>EMPRESA:</h6>
                      <span t-field="o.company_id.name"/><br/>
                      <span t-field="o.company_id.street"/><br/>
                      <span t-field="o.company_id.city"/>, 
                      <span t-field="o.company_id.state_id"/>,
                      <span t-field="o.company_id.country_id"/>.<br/>
                      CP:
                      <span t-field="o.company_id.zip"/><br/>
                      RFC:
                      <span t-field="o.company_id.vat"/><br/>
                      Regimen Fiscal: Coordinados<br/>
                      Expedido en: LAGOS DE MORENO, Jalisco, C.P.47400
                    </div>-->
                    <div class="col-6 text-left p-3" style="font-size: 10px; color: BLACK; border: 0px solid #000;">
                      <h6>CLIENTE:</h6>
                      <span t-field="o.partner_id"/><br/>
                      <span t-field="o.partner_id.street_name"/><br/>
                      No.
                      <span t-field="o.partner_id.street_number"/>
                      Int.
                      <span t-field="o.partner_id.street_number2"/><br/>
                      Colonia:
                      <span t-field="o.partner_id.l10n_mx_edi_colony"/><br/>
                      <span t-field="o.partner_id.l10n_mx_edi_locality_id"/>,
                      <span t-field="o.partner_id.city"/>,
                      <span t-field="o.partner_id.city_id"/>,
                      <span t-field="o.partner_id.state_id"/>,<br/>
                      <span t-field="o.partner_id.country_id"/>.<br/>
                      CP:
                      <span t-field="o.partner_id.zip"/><br/>
                      RFC:
                      <span t-field="o.partner_id.vat"/><br/>
                      
                    </div>
                  </div>
                </div>
                <!--
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-2 text-center font-weight-bold"><br/>Fecha de Factura:</div>
                    <div class="col-2 text-center font-weight-bold"><br/>Fecha de Vencimiento:</div>
                    <div class="col-2 text-center font-weight-bold"><br/>Moneda:</div>
                    <div class="col-2 text-center font-weight-bold"><br/>Uso CDFI:</div>
                    <div class="col-2 text-center font-weight-bold"><br/>Forma de Pago:</div>
                    <div class="col-2 text-center font-weight-bold"><br/>Método de Pago:</div>
                  </div>
                  <div class="row">
                    <div class="col-2 text-center"><span t-field="o.invoice_date"/></div>
                    <div class="col-2 text-center"><span t-field="o.invoice_payment_term_id"/></div>
                    <div class="col-2 text-center"><span t-field="o.currency_id"/></div>
                    <div class="col-2 text-center"><span t-field="o.l10n_mx_edi_usage"/></div>
                    <div class="col-2 text-center"><span t-field="o.l10n_mx_edi_payment_method_id.code"/> - <span t-field="o.l10n_mx_edi_payment_method_id"/></div>
                    <div class="col-2 text-center"><span t-field="o.l10n_mx_edi_payment_policy"/></div>
                  </div>
                    <hr class="my-4"/>
                </div>
                -->


                <div class="container-fluid"> 
                  <div class="row" style="font-size: 12px;">
                      <table class="table table-sm o_main_table" name="invoice_line_table">
                        <thead>
                          <tr>
                            <th name="th_description" class="text-left"><span>Fecha de Factura:</span></th>
                            <th name="th_description" class="text-left"><span>Fecha de Vencimiento:</span></th>
                            <th name="th_description" class="text-left"><span>Moneda:</span></th>
                            <th name="th_description" class="text-left"><span>Uso CDFI:</span></th>
                            <th name="th_description" class="text-left"><span>Forma de Pago:</span></th>
                            <th name="th_description" class="text-left"><span>Método de Pago:</span></th>
                          </tr>
                        </thead> 
                        <tbody class="invoice_tbody">
                          <td class="text-left"><span t-esc="o.invoice_date"/></td>
                          <td class="text-left"><span t-field="o.invoice_payment_term_id"/></td>
                          <td class="text-left"><span t-field="o.currency_id"/></td>
                          <td class="text-left"><span t-field="o.l10n_mx_edi_usage"/></td>
                          <td class="text-left"><span t-field="o.l10n_mx_edi_payment_method_id.code"/> - <span t-field="o.l10n_mx_edi_payment_method_id"/></td>
                          <td class="text-left"><span t-field="o.l10n_mx_edi_payment_policy"/></td>
                        </tbody>
                      </table>

                    <hr class="my-4"/>
                  </div>
                </div>


                <div class="container-fluid"> 
                  <div class="row" style="font-size: 12px;">
                      <table class="table table-sm o_main_table" name="invoice_line_table">
                        <thead>
                          <tr>
                            <th name="th_description" class="text-left"><span>Código<br/>Producto:</span></th>
                            <th name="th_description" class="text-left"><span>Asin:</span></th>
                            <th name="th_description" class="text-left"><span>Descripción:</span></th>
                            <th name="th_description" class="text-left"><span>Cantidad:</span></th>
                            <th name="th_description" class="text-left"><span>Precio<br/>Unitario:</span></th>
                            <th name="th_description" class="text-left"><span>Impuestos:</span></th>
                            <th name="th_description" class="text-left"><span>Importe:</span></th>
                          </tr>
                        </thead>
                        <t t-foreach="o.invoice_line_ids" t-as="productos" >   
                          <tbody class="invoice_tbody">
                            <td class="text-left"><span t-esc="productos.product_id.unspsc_code_id.code"/></td>
                            <td class="text-left"><span t-field="productos.Asin"/></td>
                            <td class="text-left"><span t-field="productos.name"/></td>
                            <td class="text-left"><span t-field="productos.quantity"/></td>
                            <td class="text-left"><span t-field="productos.price_unit"/></td>
                            <td class="text-left"><span t-field="productos.tax_ids"/></td>
                            <td class="text-left"><span t-field="productos.price_subtotal"/></td>
                          </tbody>
                        </t>
                      </table>

                    <hr class="my-4"/>
                  </div>
                </div>


                <div class="clearfix">
                    <div id="total" class="row" style="font-size: 12px;">
                        <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ml-auto">
                            <table class="table table-sm" style="page-break-inside: avoid;">

                                <!--Tax totals-->
                                <t t-set="tax_totals" t-value="json.loads(o.tax_totals_json)"/>
                                <t t-call="account.document_tax_totals"/>

                                <!--Payments-->
                                <t t-if="print_with_payments">
                                    <t t-if="o.payment_state != 'invoicing_legacy'">
                                        <t t-set="payments_vals" t-value="o.sudo()._get_reconciled_info_JSON_values()"/>
                                        <t t-foreach="payments_vals" t-as="payment_vals">
                                            <tr>
                                                <td>
                                                    <i class="oe_form_field text-right oe_payment_label">Paid on <t t-esc="payment_vals['date']" t-options="{&quot;widget&quot;: &quot;date&quot;}"/></i>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="payment_vals['amount']" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                                </td>
                                            </tr>
                                        </t>
                                        <t t-if="len(payments_vals) &gt; 0">
                                            <tr class="border-black">
                                                <td><strong>Amount Due</strong></td>
                                                <td class="text-right">
                                                    <span t-field="o.amount_residual"/>
                                                </td>
                                            </tr>
                                        </t>
                                    </t>
                                </t>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="container-fluid">
                  <div class="row" style="font-size: 12px;">
                    <div class="col-12 text-left">
                      <br/>
                      Por favor utilice la siguiente referencia al realizar su pago: <span t-field="o.name"/>  
                      <br/>
                      Plazo de pago: <span t-field="o.invoice_payment_term_id"/>
                      <br/>
                      <t t-set="cfdi_vals" t-value="o._l10n_mx_edi_decode_cfdi()"/>
                      <t t-set="is_cfdi_signed" t-value="bool(o._get_l10n_mx_edi_signed_edi_document())"/>
                      <t t-if="is_cfdi_signed">
                          <p>
                              <span t-esc="o._l10n_mx_edi_cfdi_amount_to_text()"/>
                          </p>
                      </t>
                      <p><span t-field="o.narration"/></p>  
                    </div>
                  </div>
                </div>



                <div class="container-fluid">
                  <div class="row" id="complement">
                    <div t-if="cfdi_vals.get('sello')" class="barcode col-2">
                        <img alt="Barcode" t-att-src="'/report/barcode/?type=QR&amp;value=%s&amp;width=130&amp;height=130' % quote_plus(                             'https://verificacfdi.facturaelectronica.sat.gob.mx/default.aspx?' + keep_query(                                 re=o.l10n_mx_edi_cfdi_supplier_rfc, rr=o.l10n_mx_edi_cfdi_customer_rfc,                                 tt='%.*f' % (o.currency_id.decimal_places, o.l10n_mx_edi_cfdi_amount), id=o.l10n_mx_edi_cfdi_uuid)                                 + '&amp;fe=%s' % quote_plus(                                     cfdi_vals['sello'][-8:], 'utf-8', 'strict', '=/').replace('%2B', '+'))"/>
                    </div>
                    <div class="complement-details col-10">
                        <div class="digital-stamp">
                            <span>Digital stamp of the emitter</span>
                        </div>
                        <div class="digital-stamp-content">
                            <span t-esc="cfdi_vals.get('sello')"/>
                        </div>
                        <div class="digital-stamp">
                            <span>Digital stamp SAT</span>
                        </div>
                        <div class="digital-stamp-content">
                            <span t-esc="cfdi_vals.get('sello_sat')"/>
                        </div>
                        <div class="digital-stamp">
                            <span>Original chain complement of digital certification SAT</span>
                        </div>
                        <div class="digital-stamp-content">
                            <span class="nowrap" t-esc="cfdi_vals.get('cadena')"/>
                        </div>
                        <div class="digital-stamp">
                            <span>Extra Info</span>
                        </div>
                        <div class="digital-stamp-content">
                            <span>Emitter certificate:</span> <span t-esc="cfdi_vals.get('certificate_number')"/>
                            <span> | SAT Certificate:</span> <span t-esc="cfdi_vals.get('certificate_sat_number')"/>
                            <span> | Expedition place:</span> <span t-esc="cfdi_vals.get('expedition')"/>
                            <span> | Fiscal Regime:</span><span t-esc="cfdi_vals.get('fiscal_regime')"/>
                            <span> | Emission Date:</span> <span t-esc="cfdi_vals.get('emission_date_str')"/>
                            <span> | Certification Date:</span> <span t-esc="cfdi_vals.get('stamp_date')"/>
                            <span> | Fiscal Folio:</span> <span t-esc="cfdi_vals.get('uuid')"/>
                        </div>
                        <div class="digital-stamp-content text-center">
                            <strong>This document is a printed representation of a CFDI</strong>
                        </div>
                    </div>
                  </div>
                </div>
            </t>
        </t>
    </t>
  </template>
</odoo>






